<?php

use Illuminate\Foundation\Testing\DatabaseMigrations;

class SpheresTest extends TestCase
{
    use DatabaseMigrations;

    protected function setUp()
    {
        parent::setUp(); // TODO: Change the autogenerated stub
        $this->setAuthToken();
    }



    public function testIndex()
    {
        $spheres = factory(\App\Type\Sphere::class, 4)->create();

        $r = $this->get('/api/spheres?token=' . $this->token);
            $r->seeStatusCode(200)
            ->seeJsonStructure([
                'data' => [
                    '*' => [
                        'id',
                        'title'
                    ]
                ]
            ]);

        $spheres = json_decode($r->response->content())->data;
        $this->assertEquals(6, count($spheres));

    }



    public function testIndexAuth()
    {
        $this->get('/api/spheres')
            ->seeStatusCode(401);
    }



}
